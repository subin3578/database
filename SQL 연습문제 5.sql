



#5-2
CREATE TABLE CUSTOMER (

custId INT PRIMARY KEY AUTO_INCREMENT,
name VARCHAR(10) NOT NULL,
address VARCHAR(20) ,
phone VARCHAR(13)
);

CREATE TABLE BOOK (
bookId INT PRIMARY KEY,
bookName VARCHAR(20) NOT NULL,
publisher VARCHAR(20) NOT NULL,
price INT 
);

CREATE TABLE `ORDER` (
orderID INT PRIMARY KEY AUTO_INCREMENT,
custId INT NOT NULL,
bookId INT NOT NULL,
salePrice INT NOT NULL,
orderDate DATE NOT NULL);

#5-3
INSERT CUSTOMER (NAME, ADDRESS, PHONE) VALUE 
("박지성","영국 맨체스타","000-5000-0001"),
("김연아","대한민국 서울","000-6000-0001"),
("장미란","대한민국 강원도","000-7000-0001"),
("추신수","미국 클리블랜드","000-8000-0001");
INSERT CUSTOMER (NAME, ADDRESS) VALUE ("박세리","대한민국 대전");

INSERT BOOK VALUE
(1,"축구의 역사","굿스포츠",7000),
(2,"축구아는 여자","나무수",13000),
(3,"축구의 이해","대한미디어",23000),
(4,"골프 바이블","대한미디어",35000),
(5,"피겨 교본","굿스포츠",8000),
(6,"역도의 단계별기술","굿스포츠",6000),
(7,"야구의 추억","이상미디어",20000),
(8,"야구를 부탁해","이상미디어",13000),
(9,"올림픽 이야기","삼성당",7500),
(10,"Olympic champions","Pearson",13000);

INSERT `ORDER` (custid,bookid,saleprice,orderdate) VALUE
(1,1,6000,'2014-07-01'),
(1,3,21000,'2014-07-03'),
(2,5,8000,'2024-07-03'),
(3,6,6000,'2014-07-04'),
(4,7,20000,'2014-07-05'),
(1,2,12000,'2014-07-07'),
(4,8,13000,'2014-07-07'),
(3,10,12000,'2014-07-08'),
(2,10,7000,'2014-07-09'),
(3,8,13000,'2014-07-10');

#5-4
SELECT custid , name, address FROM CUSTOMER;
#5-5
SELECT bookName, price FROM BOOK;
#5-6
SELECT price, bookName FROM BOOK;
#5-7
SELECT BOOKID, BOOKNAME, PUBLISHER, PRICE FROM BOOK;
#5-8
SELECT PUBLISHER FROM BOOK;
#5-9
SELECT DISTINCT PUBLISHER FROM BOOK;
SELECT PUBLISHER FROM BOOK GROUP BY PUBLISHER;
#5-10
SELECT * FROM BOOK WHERE PRICE >=20000;
#5-11
SELECT * FROM BOOK WHERE PRICE< 20000;
#5-12
SELECT * FROM BOOK WHERE PRICE BETWEEN 10000 AND 20000;
#5-13
SELECT BOOKID, BOOKNAME, PRICE FROM BOOK WHERE PRICE BETWEEN 15000 AND 30000;
#5-14
SELECT * FROM BOOK WHERE BOOKID IN(2,3,5);
#5-15
SELECT * FROM BOOK WHERE BOOKID%2=0;
#5-16
SELECT * FROM CUSTOMER WHERE SUBSTRING(NAME,1,1) = '박';
SELECT * FROM CUSTOMER WHERE `name` LIKE '박%';
#5-17
SELECT * FROM CUSTOMER WHERE SUBSTRING(address,1,4) = '대한민국';
SELECT * FROM CUSTOMER WHERE address LIKE '%대한민국%';
#5-18
SELECT * FROM CUSTOMER WHERE PHONE IS NOT NULL;
#5-19
SELECT * FROM BOOK WHERE PUBLISHER IN("굿스포츠","대한미디어");
#5-20
SELECT PUBLISHER FROM BOOK WHERE `BOOKNAME` = "축구의 역사";
#5-21
SELECT PUBLISHER FROM BOOK WHERE `BOOKNAME` LIKE "%축구%";
#5-22
SELECT * FROM BOOK WHERE BOOKNAME LIKE "_구%";
#5-23
SELECT * FROM BOOK WHERE BOOKNAME LIKE "%축구%" AND PRICE > 20000;
#5-24
SELECT * FROM BOOK ORDER BY BOOKNAME;
#5-25
SELECT * FROM BOOK ORDER BY PRICE, BOOKNAME;
#5-26
SELECT * FROM BOOK ORDER BY PRICE DESC, PUBLISHER ASC;
#5-27
SELECT * FROM BOOK ORDER BY PRICE DESC LIMIT 3;
#5-28
SELECT * FROM BOOK ORDER BY PRICE LIMIT 3;
#5-29 
SELECT SUM(SALEPRICE) AS 총판매액 FROM `ORDER`;
#5-30
SELECT 
SUM(SALEPRICE) AS 총판매액, 
AVG(SALEPRICE) AS 평균값,
MIN(SALEPRICE) AS 최저가,
MAX(SALEPRICE) AS 최고가
FROM `ORDER`;

#5-31
SELECT COUNT(ORDERID) AS 판매건수 FROM `ORDER`;
#5-32
SELECT REPLACE(BOOKNAME,'야구','농구') FROM `BOOK`;
#5-33 
SELECT O.CUSTID, COUNT(O.ORDERID) AS 수량
FROM BOOK AS B
JOIN `ORDER` AS O
ON B.BOOKID= O.BOOKID
WHERE B.PRICE > 8000
GROUP BY O.CUSTID
HAVING COUNT(O.ORDERID)>=2;

#5-34
SELECT * 
FROM CUSTOMER AS C
JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID;

#5-35
SELECT * 
FROM CUSTOMER AS C
JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID
ORDER BY C.CUSTID; 

#5-36
SELECT NAME, SALEPRICE
FROM CUSTOMER AS C
JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID;

#5-37
SELECT NAME, SUM(SALEPRICE) AS '총 판매액'
FROM CUSTOMER AS C
JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID
GROUP BY C.CUSTID
ORDER BY NAME;

#5-38
SELECT NAME, BOOKNAME
FROM CUSTOMER AS C
JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID
JOIN BOOK AS B
ON B.BOOKID = O.BOOKID;

#5-39
SELECT NAME, BOOKNAME
FROM CUSTOMER AS C
JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID
JOIN BOOK AS B
ON B.BOOKID = O.BOOKID
WHERE B.PRICE = 20000;

#5-40
SELECT NAME, SALEPRICE 
FROM CUSTOMER AS C
LEFT JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID;

#5-41
SELECT SUM(SALEPRICE) AS '총 판매액'
FROM CUSTOMER AS C
JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID
WHERE NAME = "김연아";

#5-42
SELECT BOOKNAME FROM BOOK WHERE PRICE ORDER BY PRICE DESC LIMIT 1;

#5-43
SELECT NAME
FROM CUSTOMER AS C
LEFT JOIN `ORDER` AS O
ON C.CUSTID = O.CUSTID
WHERE O.ORDERID IS NULL;

#5-44
INSERT INTO BOOK VALUE (11,"스포츠의학", "한솔의학서적",NULL);
SELECT * FROM BOOK;

#5-45
UPDATE CUSTOMER SET ADDRESS = "대한민국 부산" WHERE CUSTID = '5';
SELECT * FROM CUSTOMER;

#5-46
DELETE FROM CUSTOMER WHERE CUSTID = '5';
SELECT * FROM CUSTOMER;
